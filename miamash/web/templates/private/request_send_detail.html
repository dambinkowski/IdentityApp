{% extends "private/base.html" %}
{% block content %}

<!-- Main content header -->
<div class="row align-items-center mb-2">
    <div class="col">
        <h2>Sent Request Detail</h2>
        <p>Details for sent request</p>
    </div>
</div>

<!-- Main content body  -->
<!-- Request details general  -->
<div class="row justify-content-center">
    <div class="col-md-8 col-lg-6 col-xl-5">
        <div class="card shadow-lg m">
            <div class="card-body">
                <!-- Request sender label  and status in one line  -->
                <div class="d-flex justify-content-between">
                    <div>
                        <p class="text-muted mb-0 small">Request Receiver:</p>
                    </div>
                    <!-- Status -->
                    {% if send_request.status == "pending" %}
                    <span class="badge bg-warning">Pending</span>
                    {% endif %}
                    {% if send_request.status == "accepted" %}
                    <span class="badge bg-success">Accepted</span>
                    {% endif %}
                    {% if send_request.status == "denied" %}
                    <span class="badge bg-danger">Denied</span>
                    {% endif %}
                </div>
                <h5 class="card-text ps-4">{{ send_request.receiver }}</h5>

                <!-- Context -->
                <p class="text-muted mb-0 mt-3 small">Reasoning:</p>
                <p class="card-text ps-4">{{ send_request.request_reasoning }}</p>

                <!-- Created at -->
                <p class="text-muted mb-0 small">Created at:</p>
                <p class="card-text ps-4">{{ send_request.created_at }}</p>
            </div>
            <!-- Action links -->
            
            <div class="card-footer d-flex gap-4 justify-content-end">
                <!--  Edit button -->
                <span>
                    <a class="btn btn-warning me-4" href="{% url 'request-send-update' send_request.id %}">Edit Request</a>
                </span>
                <!-- Delete button -->
                <span>
                    <form method="POST" action="{% url 'request-send-delete' send_request.id %}">
                        {% csrf_token %}
                        <button class="btn btn-danger" type="submit" onclick="return confirm('Are you sure you want to delete this request?');">
                            Delete Request
                        </button>
                    </form>
                </span>

            </div>
        </div>
    </div>
</div>
<!-- List of variants in request  -->
<div class="row align-items-center mb-2 mt-4">
    <hr>
    <div class="col">
        <h2>Variants requested</h2>
        <p>This is the list of information, that sender would like for you to share with them.</p>
    </div>
    <div class="col-auto">
            <a class="btn btn-primary btn-lg" href="{% url 'request-send-request-identity-variant-create' send_request.id %}">Add Variant To Request</a>
        </div>
    </div>



{% if request_identity_variants %}
    <!-- set the grid  -->
        <div class="row row-cols-1 row-cols-sm-1 row-cols-md-2 row-cols-lg-3 row-cols-xl-4 row-cols-xxl-5  g-4">
            <!-- loop throught variants -->
            {% for variant in request_identity_variants %}
                <div class="col">
                    <!-- Card details  -->
                    <div class="card h-100 mb-3 shadow-lg">
                        <div class="card-body d-flex flex-column">
                            <!-- Label -->
                            <p class="text-muted mb-0 small">Label:</p>
                            <h5 class="card-text ps-4 ">{{ variant.label }}</h5>

                            <!-- Context -->
                            <p class="text-muted mb-0 mt-3 small">Context:</p>
                            <p class="card-text">{{ variant.context }}</p>

                            <!-- Spacer to push variant to bottom to even out across the cards -->
                            <div class="flex-grow-1"></div>
                            
                            <!-- Shared information (don't show none )-->
                            <p class="text-muted mb-0 small"></p>
                            {% if variant.profile_link %}
                            <h5 class="card-text text-center"> {{variant.profile_link.variant}}</h5>
                            {% else %}
                            <p class="card-text text-center">---</p>
                            {% endif %}
                        </div>
                        <!-- detail link footer -->
                        <div class="card-footer text-end">
                            <a class="btn btn-blue" href="{% url 'request-send-request-identity-variant-detail' variant.request.id variant.id %}"">View Details</a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>                     
    {% else %}
        <div class="text-center mt-4">
            <p>Person sending the request hasn't added fields for information they need. They still might add them later.</p>
        </div>
    {% endif %}
{% endblock %}
