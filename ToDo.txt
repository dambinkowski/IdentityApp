#       TO DO        # 

+ test if django is running 
+ add apps to settngis 
+ structure url 
+ create url files 
+ home page, url, view, html 
+ make migrations to add apps 


+ API 
+ profile identity variants 

+ request send 
+ create method 
valiadet data 
{'receiver': {'username': 'Michael'}, 'request_reasoning': 'how you doin'}
i need to access username to put it to creation 
okay with update had to go back, and create extra field
because I don't want to be able to update receiver becaues then that would relate 
to links etc. 
now serializer is different 
okay i give up I am gonna use generic view for this part
there is so much logic that might as well 
redoing keep viewsets for profile identity variants 
but for requests I am going to explicitly set 
+ request / send / get list - post new 
+ request / send / {pk} / - get detials, put update delete 
- add list of request identity variants 
because of separation between sender and receiver
i can make serializer with link for sender to be read only for safety 

+ request / send / {pk} / 
- update method 
uperantly using roture i need 
- request received
i want to add documentiatno since I am moving away from 
roture, I liked how links were shown, so I want to see 
documentiation, I was going to use swagger because it sometihng I was learnig 
at the coures, but then when reading OpenAPI documentiatno,  I 
checked django documentiatn for documenting api 
https://www.django-rest-framework.org/topics/documenting-your-api/
and I found recomandation for drf-spectacular so I am gonnat try that 
pip install drf-spectacular 
https://drf-spectacular.readthedocs.io/en/latest/readme.html

i was about to start web but then decided to create tests 
so when something doesnt work on website i know its not the 
backend issue 

when doing tests, i craetd user in setup, then i craete test case 
for sucselful registration, and i couldnt' understand why i am keep getitng error
manually it works, then i use print method for error msg to realzie that 
user already exits in setup because username has to be unique 

i spend so much time already writing tests, i had more errors writing tests wrong then
the app i was thinknig if there is some automatic testing 
i found schematics but then I realize, tests i wanted to make
are very specific, user action or app logic specific 
what is the input and what the result should be 
so I went back to writing them myself... 


okay making tests 
i realized that often is 404 for not found instead of unathoridez of forbidden, becasuse 
I use safety by not allowing user to ever be able to write a sender as input when creating the request 
or accesing request where sender 
I realzied my issue was that it return empty set 
deep dive into why is it empty set [] 200ok, then reading how it runs global permissions not object permission 
then i decided to leave it 

so i discovered has_object_permission only runs on Retrive/Update/Destroy, 
I thought when I am setting permission on the object any action with this object only permission allows to ever view it 
but list does not work like that, it does only check global has_permission, so to protect the view, 
filter what query set should return, and only filter data will show, so if user is trying 
to find something using pk, and I add filetr, that user has to be X it will return 404, because 
there is no match for that, but its not there is something like that but you don't have access to it 
I wonder if i should do explicit, user gave this pk for request,
its different then I first assumed but I guess it does make sense, I did start to research how to make 
forbidden, by adding some logic, then decided to stick to default, jus tests are going to be different with 
no found , or empty set, but again as long as data is invisible, and it has approach that 
- its not:  server has the resource you don't have access to it 
its 
- not of the resource that you have access too has those parameters 

as i was working on tests, i realized, i never run the feature of linking the profile identity with request
i did it in admin page, and then it showed it request send 
while doing tests i realze i keep getting error, first i thought its because the fields is read onlyt
then i realzied its the issue with permisssions again because the nested object has no .receiver atribute 
so permission class in trying to check permission 
so I need to etither write new permission class for the nested object or in main permission add logic 

of course I had to name one of the models - request - now it makes it confusing with django built in request 
i realized that it also shouldnt work in send because i used the same approach, 
then realized i didnt test for that and indeed it does not work
so i need to rebuild security system, add test for request sends, and finish request recevie identity varianst 

so basically i can not run has permission - to detrmine if its sender or receiver becuase that parts 
of DRF runs before even trying to get any obects, now if that passes, object is return and now 
I can check permision between object and a user, because drf has run the query, got the object and
has object info, that info now contains who is sender and who is receiver, 

okay great, now I have permission on the object, but i have request-identity-variant, where parent is 
request, os request-identity-variant does not users information of who is sender or receiver, 
because that info is in the request model, but update/retrive/destroy in the view still uses 
get_query_set so if user where to get details for that item, or update it 
it just wouldn't be fount because its not accessible, question is 
should i make it explicit or not 

so now I am used to checking hasattr because its what i need when I gave custom attributes in project before 
but also there has to be more readible way what if 2 objects have same attribute etc. so I just used 
python isInstance, to see what object is, if its Request check request.sender with request.user 
if its RequestIdentityVariant get RequestIdentityVariant.Request.sender 

i got to the point i have over 64 tests, and it takes 18 seconds to run it 
i like to make comments of what tests i need to do before coding, so I realzied i still have 
over at least 20 tests to do, I am not gona wait as I code, i remember from class i can specify which test i want to run
but typing it in is long so 
so did quick research how to make bash command that I can just add parametr which will be test name 

maybe test driven development is good, i coppied and pasted permisisons from request, and of course i change to
compere with status.ACCEPTED not with user to be receiver, but i did'nt change left side, so I was compering 
using tests i noticed this comes back false when it should be true, 

next functionaliny is tthat when user changes their mind and decides to deny request, their data should not be shared anymore
so I was going to loop over requestidentityvariants of request and wipe the links out, but then I was thinking if i woudl make query 
call for each instance, in Express i was trying to make as little queries as posible and I would have such an action in one query 
so I looked and Django does have bulk update which is much more scallable 

deciding on next step still going back and forth with doing react 
https://www.contentful.com/blog/htmx-react-use-cases/
I have the api tested and secured, so I don't want to rewrite the logic, and testing and security for the views 
but on the other hand react seems like unnesesesry since most logic is in the server side, and there is 
no significant optimization to have it moved 

okay already running into issues with allauth, i cant find the url patterns names -.- 

reading all auth documentiation, I like they safety aproach that can not check if email hass acount 

silly bug 
i took hours trouble shooting why is my all-auth login page not showing, 
i didn't set up profile/dashboard page becauese i did read documentiation 
and it shoudl work right out of the box the signup and login page 
so I took such a long time making sure everything is installed, 
digged deep int example project from documentaion, and just went with 
basic instalation example and it still did'nt work 
then i realize that the silly mistake was that user was already logged in 
because i was testing browsable api, and since I enabled django sessions for that 
authentication of course stayed for web requests...
so the reason it was not working its because it was redirecting to profile ( i customized it to dashobard later)
hours of why is rediracting happening.... 
anyways logged out using api, and there it was signup up page and login page worked like they supposed to 
then I created dashboard page, made it login requeire mixin and once login through allouth redirec there
in prototype i used funtion based views, but since i want to use inharitance for classes, 
and take advantage of object oriented programiming i change to class view even for dashboard 

my next step is to continue making web page endpoints 
i will stay focused and not do any css until every functionality is done 

i am gonig to make website endiponits identical or very similar to api endponits 

okay so I thought i can just set up reponse to be html renderere, and I will be good to go 
but I also need to overide get response to change it from json to dict for template to 
be able to get data 

next issue was i see data data[0].key but apperantly its data.0.key becaues its python dictionaries 

so glad i defined urls as variabless in setup so it was easy to change name for urls adding api in front, so web can use without api 

okay this is not saving time, trying to make html form with errors is not easy 
DRF is not made for this, so switch of plans, I am gonig to use django, and create permissions again, i think i will be faster doing that
then read bunch of DRF documentaitnos trying to make things work, django templetes were made to handle those html actions 
so that is a big switch 

lets go 
\
i was thking to do permissions.py file again 

normalyl i would just hard code the url, but then i came across reverse lazy in one of django tutorials, 
so i did reasrceha in documention, and its the way its common practice to use url name 
so if i ever need to change path, i don't need to change hardcoded values, because its all connected to name 

i am making views one by one, keeping them separated, i am tired to make one fit all for purpose of basic funcionaly 
now django is really helpfuul, i am maknig view, and then I get visible errror that i didn't set get queryset or 
that after edditg using generic update view, I need sucselful url where app should go 
so developing with django is great 

as i keep reading different part of documention i keep finding things,
 i realize i don't need to do forms.py because i can just oxpose fields in create view 
 https://docs.djangoproject.com/en/5.2/ref/class-based-views/generic-editing/#django.views.generic.edit.CreateView
because create view inharitace is from form mixin 

i actually decided to stick to extenting form file, because  then to DRY i would have to put in permissions, 
and that is not good separation of concerns, so even tho I could just set up field, I prefer 
to have forms in forms file, permissions in permissions file, and logic in logic file - that uses permissions, and forms when nessesesry 

receiver is a dropdown field by default, for safety i am going to overide that, and declare it as charfield, 

i rememeber having hard time with funcnion based views, that I wanted to have multiple query results for different objects in 
one view, so I came across funciton get or 404, that would use to get objcets, and combine them dictionary and pass them to template 
well funcion based view i came across simpler solution that overites context_data where context data is data being passed to template 
now in that place add other keys and values to context 

so I am overiding the request, and then funcion is modular, but I know the objcet Request has request_identity_variants that I can call all for 
that instance, but at pylance dos'nt know that, so it's red and I don't like it so searching how to solve this, i just used # type: ignore 

IDOR vurnebility, so I am making this separation of coners different views for different actions even tho they use the same template, 
this way i can use one view for get and other view for post, but now when I make post view - i need to secure it
becasue mixin will protect from get, but when its come to post, django comes battery included - but single connecnion and so many 
overrides right away, there is another package guardian - but I am at the point i don't want to read documentatino of other things and customize it
to work, so I am just gonna make another permission class, and overide stuff to make sure objects are allowed for that user before action... 

so i came across that update view takes Request.user.id and i need Request.user.username, which is funny becasue form is populated with int
but data gets cleaned so its looking at it as username, so its loads id but expects username, first i was gonna change it in form part
but then i realzide i would need form robust if its initial or update, then i was why would i do that logic here if there are literlly 
two separate views, since django is so robust, i have decided to just override initial data in update view and return overiden value back 
i forgot i made design decision, that receiver can not be changed, because that seems more common expected behavionr 

django is great, i can just access parent by using request_identity_variant.request.PARENTFIELDS so this nice, but because of that i need to 
do more tests for security, so i added Request level check as well 

request_identity_variant built in view of course was looking by default at pk but pk is request, and I need detail for request_identity_variant, 
those errors are hard to detect because its not code i wrote, it's the code that comes with django and only error i was getting is 404 not found
so I knew someting with the mixin isn't right, but then parametrs in URL were correctly passed, so I realzied i need to overide for 
the detail view which of passed parametr reflect to request_identity_variant 

i keep want to add repetitive code to mixin, but its permission mixin so I am trying to make logic separate, but then two lines of code are 
fine to not create another mixin 

okay next i need to set up that only accepted requests users can add links, like in api same for web view 
so server side returns 404 if user tries to access 

got back to coding i forgot has_object_permission is rest class, and django generic view is not calling it so that method is nerev called, 
i will just use dispatch 


its what is a good moment to check permisison, so I use methods that views call its not fully independent check, generic update view 
call dispatch and then get object, oveririding get_object seems like the most apropariate moment 
because of that i need to do a lot of type ignore, maybe i should have make it more independednt make a class method, custom 
and then call it from view and in the view overide get and call that method hmm 




as wrting draf report i realize request send i set sender twice fix it later 
as i writing draft request send identity variant detail does not use lookup so where is test for that 
add references for how i fourd drf spectacular and other sigrificant links from here 

okay so i didn't miss tesst does check, but i am passing variables to view, instead of in urls so it knows which values I am asking for 
nope that was not the case, i still make url using lambda

hello oppa
i hope this coding bit isnt giving you too hard of a time rn 
love you 


just discovered 
django.contrib.messages 
while going over documentation of bootstrap for jdango 
https://django-bootstrap5.readthedocs.io/en/latest/quickstart.html#example-template

okay lets start styling
https://getbootstrap.com/docs/5.3/getting-started/introduction/

doing main content cards 
https://getbootstrap.com/docs/5.3/components/card/

moving from list items to div cards using bootstrap 
i don't like how disaligned label, context, variant are so I am going to use same approach that i figured out for main 
wesbite grid using d-flex single column streach 

okay next i have request received
i reused the gird and layout from profile identity variant, 
changed variant to created at and other fiedls to correspond to request recievd data 
but I also have status I kind of want to make it float in right top corner 

next send should be pretty similar to receaive 

i just catched myself again instead of keeep going I am like bootstrap form is a little white should i customize it more 
and I could really go into rabit hole to make this form look cooler 

also i was getting error that bootstrap is not loaded, uperantly it doesn't carry over from base ? but css does ? i need to research more 
what is happening there, but I justa loaded it again at the top of the form and it worked, i assume it loads but if I am using reference like bootstrap 
form

creating new request should go to request details right away, i really should start writing unit testing, i need to go back to view logic 
and fix that, 

next is detail views, i wanted to use waring buttnos styling but i overirdden colors to look good for styling, so had to go back and refactor 


- welcome page 
- lolgin page 
- third party login 
-log out page 
- unit tests for web 
- deployment 

when doing sign in I was reading that the best pracitec is to copy given code from template in allauth and customize it, style it 

as i am going with all auth copying templates i run into {% trans %} did research how it helps building multilangual pages 

okay adding google sign in https://docs.allauth.org/en/dev/socialaccount/providers/google.html 
i was wondering about username, i like this functonality of django 
so apperently social accounts have their own templates, if i would continue on the project i would just copy the whole tepmale folder from allauth 
and then add styling to it

